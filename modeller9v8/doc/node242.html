<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>selection.superpose() -- superpose model on selection given alignment</TITLE>
<META NAME="description" CONTENT="selection.superpose() -- superpose model on selection given alignment">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="manual.css">

<LINK REL="next" HREF="node243.html">
<LINK REL="previous" HREF="node241.html">
<LINK REL="up" HREF="node220.html">
<LINK REL="next" HREF="node243.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html5279"
  HREF="node243.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5273"
  HREF="node220.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5267"
  HREF="node241.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5275"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5277"
  HREF="node470.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html5280"
  HREF="node243.html">selection.rotate_dihedrals()   change</A>
<B> Up:</B> <A NAME="tex2html5274"
  HREF="node220.html">The selection class: handling</A>
<B> Previous:</B> <A NAME="tex2html5268"
  HREF="node241.html">selection.randomize_xyz()   randomize</A>
 &nbsp; <B>  <A NAME="tex2html5276"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html5278"
  HREF="node470.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION0011922000000000000000">
selection.superpose() -- superpose model on selection given alignment</A>
</H2> <A NAME="20647"></A><A NAME="CMD:selection.superpose"></A><A NAME="20650"></A><TT>superpose(mdl2, aln, fit=True, superpose_refine=False, rms_cutoff=3.5, reference_atom='', reference_distance=3.5, refine_local=True, swap_atoms_in_res='')</TT>
<BR><DL>
<DT><STRONG>Output:</STRONG></DT>
<DD><I>SuperposeData</I><A NAME="20657"></A> object
                             
</DD>
</DL>

<P>
<BLOCKQUOTE>
This command superposes <I>mdl2</I><A NAME="20717"></A> on the selection, without
changing the alignment, <I>aln</I><A NAME="20720"></A>.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>The selection model must be the first sequence in the alignment; <I>mdl2</I><A NAME="20723"></A> must
be the second sequence in the alignment.  The equivalent atoms are the
selected atoms that have equivalently named atoms in <I>mdl2</I><A NAME="20726"></A>; the atom
equivalences are defined in library <TT>$ATMEQV_LIB</TT>.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>No fitting is done if <I>fit</I><A NAME="20729"></A> = <TT>False</TT>.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE><I>rms_cutoff</I><A NAME="20733"></A> is the cutoff used in calculating the cutoff R<SMALL>MS</SMALL> deviations;
<EM>i.e.</EM>, those position and distance R<SMALL>MS</SMALL> deviations that are defined
on the equivalent atoms which are less than <I>rms_cutoff</I><A NAME="20739"></A>
angstroms away from each other (as superposed using all aligned positions)
and those equivalent distances which are less than <I>rms_cutoff</I><A NAME="20742"></A>
angstroms different from each other, respectively.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>If <I>refine_local</I><A NAME="20745"></A> is <TT>True</TT> the superposition is then refined by
considering local similarity. The DRMS profile of the two structures is
calculated over a moving window of 11 residues, and a simple heuristic is then
used to detect boundaries between local structural fragments. Then each of
these fragments is used as the basis for least-squares fitting. The final
returned orientation is that which results in the maximum number of equivalent
positions, if any is better than the original superposition.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>If <I>superpose_refine</I><A NAME="20749"></A> is <TT>True</TT> the refinement of the superposition
is done by repeating the fitting with only those aligned pairs of
atoms that are within <I>rms_cutoff</I><A NAME="20753"></A> of each other until there is
no change in the number of equivalent positions. This refinement
can only remove compared positions, not add them like <B><A HREF="node292.html#CMD:alignment.align3d">alignment.align3d()</A></B><A NAME="20756"></A> can
do. This is useful for comparing equivalent parts of two structures
with a fixed alignment but omitting divergent parts from the
superposition and R<SMALL>MS</SMALL> deviation calculation; <EM>e.g.</EM>, comparing a model with
the X-ray structure.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>If <I>superpose_refine</I><A NAME="20763"></A> is <TT>False</TT> and <I>reference_atom</I><A NAME="20767"></A> is non-blank, only
those pairs of equivalently named selected atoms from aligned residues
are superposed that come from residues whose <I>reference_atom</I><A NAME="20770"></A> atoms are
closer than <I>reference_distance</I><A NAME="20773"></A> &#197; to each other.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>When the selection model and <I>mdl2</I><A NAME="20776"></A> have exactly the same atoms in the same
order, one can set <I>swap_atoms_in_res</I><A NAME="20779"></A> to any combination of
single character amino acid residue codes in <TT>DEFHLNQRVY</TT>.
Certain atoms (see below) in the specified sidechains of <I>mdl2</I><A NAME="20783"></A> are
then swapped to minimize their R<SMALL>MS</SMALL> deviation relative to the selection model.
The labeling resulting in the lowest R<SMALL>MS</SMALL> deviation is retained.
The following swaps are attempted:
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>
<DIV ALIGN="CENTER">
<TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="LEFT">Residue</TD>
<TD ALIGN="LEFT">Swap(s)</TD>
</TR>
<TR><TD ALIGN="LEFT">D</TD>
<TD ALIGN="LEFT">OD1, OD2</TD>
</TR>
<TR><TD ALIGN="LEFT">E</TD>
<TD ALIGN="LEFT">OE1, OE2</TD>
</TR>
<TR><TD ALIGN="LEFT">F</TD>
<TD ALIGN="LEFT">CD1, CD2</TD>
</TR>
<TR><TD ALIGN="LEFT">&nbsp;</TD>
<TD ALIGN="LEFT">CE1, CE2</TD>
</TR>
<TR><TD ALIGN="LEFT">H</TD>
<TD ALIGN="LEFT">ND1, CD2</TD>
</TR>
<TR><TD ALIGN="LEFT">&nbsp;</TD>
<TD ALIGN="LEFT">NE2, CE1</TD>
</TR>
<TR><TD ALIGN="LEFT">N</TD>
<TD ALIGN="LEFT">OD1, ND2</TD>
</TR>
<TR><TD ALIGN="LEFT">Q</TD>
<TD ALIGN="LEFT">OE1, NE2</TD>
</TR>
<TR><TD ALIGN="LEFT">R</TD>
<TD ALIGN="LEFT">NH1, NH2</TD>
</TR>
<TR><TD ALIGN="LEFT">V</TD>
<TD ALIGN="LEFT">CG1, CG2</TD>
</TR>
<TR><TD ALIGN="LEFT">Y</TD>
<TD ALIGN="LEFT">CD1, CD2</TD>
</TR>
<TR><TD ALIGN="LEFT">&nbsp;</TD>
<TD ALIGN="LEFT">CE1, CE2</TD>
</TR>
</TABLE>
</DIV>
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>On successful completion, a <I>SuperposeData</I><A NAME="20788"></A> object is returned, which
contains all of the calculated data. For instance, if you save this in a
variable 'r', the following data are available:
</BLOCKQUOTE>
<UL>
<LI><TT>r.initial_rms</TT>; the RMS before superposition
</LI>
<LI><TT>r.rms</TT>; the RMS after superposition
</LI>
<LI><TT>r.drms</TT>; the distance RMS after superposition
</LI>
<LI><TT>r.cutoff_rms</TT>; the RMS after superposition of atoms within <I>rms_cutoff</I><A NAME="20795"></A>
</LI>
<LI><TT>r.cutoff_drms</TT>; the DRMS after superposition of distances within <I>rms_cutoff</I><A NAME="20799"></A>
</LI>
<LI><TT>r.rotation</TT>; the rotation matrix that was used to transform <I>mdl2</I><A NAME="20803"></A> (applied first), if <I>fit</I><A NAME="20806"></A> is <TT>True</TT>
</LI>
<LI><TT>r.translation</TT>; the translation that was used to transform <I>mdl2</I><A NAME="20811"></A> (applied after rotation), if <I>fit</I><A NAME="20814"></A> is <TT>True</TT>
</LI>
<LI><TT>r.num_equiv_pos</TT>; the number of equivalent positions
</LI>
<LI><TT>r.num_equiv_dist</TT>; the number of equivalent distances
</LI>
<LI><TT>r.num_equiv_cutoff_pos</TT>; the number of equivalent positions within <I>rms_cutoff</I><A NAME="20821"></A>
</LI>
<LI><TT>r.num_equiv_cutoff_dist</TT>; the number of equivalent distances within <I>rms_cutoff</I><A NAME="20825"></A>
</LI>
</UL>

<P>

<DL>
<DT><STRONG>Example: <A NAME="tex2html132"
  HREF="../examples/commands/superpose.py">examples/commands/superpose.py</A></STRONG></DT>
<DD> <BR>
<BR>
<PRE># Example for: selection.superpose()

# This will use a given alignment to superpose Calpha atoms of
# one structure (2ctx) on the other (1fas).

from modeller import *

env = environ()
env.io.atom_files_directory = ['../atom_files']

mdl  = model(env, file='1fas')
mdl2 = model(env, file='2ctx')
aln = alignment(env, file='toxin.ali', align_codes=('1fas', '2ctx'))

atmsel = selection(mdl).only_atom_types('CA')
r = atmsel.superpose(mdl2, aln)

# We can now use the calculated RMS, DRMS, etc. from the returned 'r' object:
rms = r.rms
drms = r.drms
print "%d equivalent positions" % r.num_equiv_pos

mdl2.write(file='2ctx.fit')
</PRE>
</DD>
</DL>  <BR>
<P>

<DL>
<DT><STRONG>Example: <A NAME="tex2html133"
  HREF="../examples/commands/align3d.py">examples/commands/align3d.py</A></STRONG></DT>
<DD> <BR>
<BR>
<PRE># Example for: alignment.align3d(), selection.superpose()

# This will align 3D structures of two proteins:

from modeller import *
log.verbose()
env = environ()
env.io.atom_files_directory = ['../atom_files']

# First example: read sequences from a sequence file:
aln = alignment(env)
aln.append(file='toxin.ali', align_codes=['1fas', '2ctx'])
aln.align(gap_penalties_1d=[-600, -400])
aln.align3d(gap_penalties_3d=[0, 4.0])
aln.write(file='toxin-str.ali')

# Second example: read sequences from PDB files to eliminate the
# need for the toxin.ali sequence file:
mdl = model(env)
aln = alignment(env)
for code in ['1fas', '2ctx']:
    mdl.read(file=code)
    aln.append_model(mdl, align_codes=code, atom_files=code)
aln.align(gap_penalties_1d=(-600, -400))
aln.align3d(gap_penalties_3d=(0, 2.0))
aln.write(file='toxin-str.ali')

# And now superpose the two structures using current alignment to get
# various RMS's:
mdl = model(env, file='1fas')
atmsel = selection(mdl).only_atom_types('CA')
mdl2 = model(env, file='2ctx')
atmsel.superpose(mdl2, aln)
</PRE>
</DD>
</DL>  <BR>
<P>

<DL>
<DT><STRONG>Example: <A NAME="tex2html134"
  HREF="../examples/commands/swap_atoms_in_res.py">examples/commands/swap_atoms_in_res.py</A></STRONG></DT>
<DD> <BR>
<BR>
<PRE># This script illustrates the use of the swap_atoms_in_res
# argument to the selection.superpose() command:

# Need to make sure that the topologies of the two molecules
# superposed are exactly the same:

from modeller import *
from modeller.scripts import complete_pdb

env = environ()
env.libs.topology.read(file='$(LIB)/top_heav.lib')
env.libs.parameters.read(file='$(LIB)/par.lib')

atfil = '../atom_files/pdb1fdn.ent'
mdl = complete_pdb(env, atfil)
aln = alignment(env)
aln.append_model(mdl, align_codes='orig')

mdl2 = model(env, file='1fdn.swap.atm')
aln.append_model(mdl2, align_codes='swap')
atmsel = selection(mdl)
atmsel.superpose(mdl2, aln, swap_atoms_in_res='')
atmsel.superpose(mdl2, aln, swap_atoms_in_res='DEFHLNQRVY', fit=False)
atmsel.superpose(mdl2, aln, swap_atoms_in_res='', fit=True)
</PRE>
</DD>
</DL>  <BR>
<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html5279"
  HREF="node243.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html5273"
  HREF="node220.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html5267"
  HREF="node241.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html5275"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html5277"
  HREF="node470.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html5280"
  HREF="node243.html">selection.rotate_dihedrals()   change</A>
<B> Up:</B> <A NAME="tex2html5274"
  HREF="node220.html">The selection class: handling</A>
<B> Previous:</B> <A NAME="tex2html5268"
  HREF="node241.html">selection.randomize_xyz()   randomize</A>
 &nbsp; <B>  <A NAME="tex2html5276"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html5278"
  HREF="node470.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Automatic builds
2010-04-21
</ADDRESS>
</BODY>
</HTML>
